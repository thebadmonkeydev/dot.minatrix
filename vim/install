#!/usr/bin/env bash
#
# setup vim after install
source script/helpers

export VIM_DIR="$HOME/.vim"
export JANUS_DIR="$VIM_DIR/janus"

function janus_dirs {
  ensure_dir "$VIM_DIR/_backup"
  ensure_dir "$VIM_DIR/_temp"
}

function janus_update {
  pushq "$JANUS_DIR"
    eval "
      git clean -xdf -- "$JANUS_DIR"
      git pull ${SILENCE_ALL}
      git submodule sync ${SILENCE_ALL}
      git submodule update --init ${SILENCE_ALL}
    "
  popq
}

rm -rf "$VIM_DIR"
ensure_dir "$VIM_DIR"

if [ -z ${DOTUPDATE+x} ];then
  eval "
    git clone --recursive --quiet https://github.com/carlhuda/janus.git ${VIM_DIR}/ ${SILENCE_ALL}
  "

  janus_update
  janus_dirs
else
  janus_update
fi

